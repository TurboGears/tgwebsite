
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Scheduling Tasks with TurboGears &mdash; TurboGears 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/tg.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <script type="text/javascript" src="_static/header.js"></script>
    <link rel="top" title="TurboGears 1.0 documentation" href="index.html" />
    <link rel="next" title="Custom Error Reporting" href="ErrorReporting.html" />
    <link rel="prev" title="Tips for Using Non-ASCII Characters in TurboGears" href="UnicodeTips.html" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ErrorReporting.html" title="Custom Error Reporting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="UnicodeTips.html" title="Tips for Using Non-ASCII Characters in TurboGears"
             accesskey="P">previous</a> |</li>
<li><a href="index.html">TurboGears 1.0 documentation</a> &raquo;</li>
<li id="searchbox" style="display: none; margin: 0 20px;" class="right">
  <form class="search" action="search.html" method="get">
    <span>Search:</span>
    <input type="text" name="q" size="18" />
    <input type="submit" value="Go" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</li>
<script type="text/javascript">$('#searchbox').show(0);</script>
 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">TurboGears 1.0 FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Install/index.html">Downloading and Installing TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install/Deployment.html">Deploying TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Database/index.html">Database Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/BigPicture.html">The Big Picture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TGScreencasts.html">TurboGears Screencasts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Wiki20/Page1.html">The 20 Minutes Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Controller.html">Controller Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Arguments.html">I Wanted An Argument!</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/UseDatabase.html">Data Model Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Kid.html">A Brief Introduction to Kid Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/MochiKit.html">A Brief Introduction to MochiKit</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Identity/GettingStarted.html">Getting Started With Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Introduction.html">Introduction To Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/SimpleForm.html">Simple Widget Form Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="FileUploadTutorial.html">File Upload Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ToDoListTutorial.html">Brian&#8217;s TurboGears Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TgAdmin.html">tg-admin command line tool reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="QuickStart.html">Are you ready to gear up?</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Server.html">Starting Up The Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">TurboGears Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingBigApplications.html">Creating Big Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="SpecificProblems.html">Solving specific problems</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Arguments.html">I Wanted An Argument!</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/URLs.html">Using URLs</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingBigApplications.html">Creating Big Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="RequestResponse.html">Access Request/Response Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="StaticFiles.html">Serving Static Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cookies.html">Using Cookies in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sessions.html">Using Sessions in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="FeedController.html">Serving RSS and Atom feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="UnifiedControllers.html">Unified Form Data Validation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ExposeDecorator.html">&#64;expose()</a></li>
<li class="toctree-l1"><a class="reference internal" href="ValidateDecorator.html">&#64;validate()</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorHandling.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/Usage.html">Using Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="PaginateDecorator.html">&#64;paginate()</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="StdVars.html"><tt class="docutils literal"><span class="pre">stdvars</span></tt>: Global Template Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="HeadersFooters.html">Application-wide Headers and Footers</a></li>
<li class="toctree-l1"><a class="reference internal" href="JSON.html">JSON Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="Designer.html">Designer-Friendly Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="DummyTemplate.html">Dummy Kid Template for Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="KidHTMLEntities.html">HTML Entities in Kid templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="CheckedCheckBox.html">Automatically Checking a Checkbox or Radio Button</a></li>
<li class="toctree-l1"><a class="reference internal" href="BreadCrumb.html">Breadcrumb Style Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingBigApplications.html">Creating Big Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="NonPackagedKidTemplates.html">Loading Kid templates from outside your application package</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenshiInternationalizationWithBabel.html">Genshi Templates Internationalization with Babel</a></li>
<li class="toctree-l1"><a class="reference internal" href="AdvancedCheetahTemplates.html">Templates for using TurboCheetah with TurboGears</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/DefineDatabase.html">Data Model Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="BackEndOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="BackEndOverview.html#supported-backends">Supported backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="DbUri.html">The DB-URI</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/index.html">SQLObject Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="TgAdminSqlUpgrade.html">How to Use <tt class="docutils literal"><span class="pre">tgadmin</span> <span class="pre">sql</span> <span class="pre">upgrade</span></tt> with SQLObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelOutsideTG.html">Using Your Model Outside of TurboGears Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultipleDatabases.html">Using Multiple Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/AutoUpdateField.html">Auto-updating an attribute with SQLObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Debug.html">SQLObject Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/DirectSQL.html">SQLObject direct SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/ForeignKeys.html">SQLObject Foreign Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/QuickGuide.html">SQLObject Quick Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/ReservedWords.html">Avoiding SQL reserved words in the model definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Caching.html">SQLObject Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Gotchas.html">SQLObject &#8220;gotcha&#8217;s&#8221;</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/StoringAndRetrievingFiles.html">Storing and Retrieving Files from a Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Views.html">Views in SQLObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/VsHibernate.html">Hibernate vs SqlObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLAlchemy/Configuration.html">SQLAlchemy Configuration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Overview.html">Widgets Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/index.html">Guide to the TurboGears Widgets Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Browser.html">WidgetBrowser</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Explore.html">Dive Into Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/SimpleForm.html">Simple Widget Form Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/FormValidationWithSchemas.html">Widget Form Validation with Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/ModifyDefaults.html">Changing Widget Defaults at Run Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/DynamicForm.html">Dynamically Modifying a Form&#8217;s Widgets With Ajax</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicValidation.html">Dynamic Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Packages.html">Widget Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/StatelessWidgets.html">StatelessWidgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/DataGrid.html">DataGrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/AjaxGrid.html">Ajax Grid Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/AutoCompleteField.html">The AutoCompleteField Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/RemoteForm.html">RemoteForm Widget Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/RemoteLink.html">Wrap Ajax Operations in Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/CompoundWidgets.html">Implementing and using CompoundWidgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/RepeatingFieldSet.html">RepeatingFieldSet Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/CalendarDatePicker.html">CalendarDatePicker Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/NicerForms.html">Nicer Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="FastData/index.html">FastData</a></li>
<li class="toctree-l1"><a class="reference internal" href="FastData/DataController.html">DataController</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Recipes.html">Widget Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Tips.html">Widget Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="ToscaWidgets.html">Using ToscaWidgets in TurboGears 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Visit/index.html">Using the Visit Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visit/Extending.html">Extending the Visit Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visit/UserTrackedLogging.html">User Tracked Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visit/PermanentLogin.html">Permanent Login</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/index.html">Identity Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/GettingStarted.html">Getting Started With Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/Usage.html">Using Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/EncryptedPassword.html">Using Identity with Encrypted Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/Recipes.html">Identity Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/OpenID.html">OpenID Authentication with TurboGears Identity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Testing.html">Testing Your Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="LoggingSystem.html">Understanding the Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorReporting.html">Custom Error Reporting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Debugging.html">Debugging a TurboGears Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="DummyTemplate.html">Dummy Kid Template for Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Debug.html">SQLObject Debugging</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="CachingTechniques.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="GzipCompressing.html">Gzip Compressing Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingPylint.html">Using Pylint to Improve the Quality of Your Code</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Toolbox.html">TurboGears Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="Admi18n.html">The Admi18n Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="Catwalk.html">CatWalk</a></li>
<li class="toctree-l1"><a class="reference internal" href="FastData/DataController.html">DataController</a></li>
<li class="toctree-l1"><a class="reference internal" href="VersionInfo.html">Toolbox Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelDesigner.html">ModelDesigner</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebConsole.html">Web Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Browser.html">WidgetBrowser</a></li>
<li class="toctree-l1"><a class="reference internal" href="DreamWeaverIntegration.html">DreamWeaver Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="VimIntegration.html">Vim Editor Integration</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="FlashNotes.html">Using Flash Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="JsonifyDecorator.html">The <tt class="docutils literal"><span class="pre">jsonify</span></tt> Decorator</a></li>
<li class="toctree-l1"><a class="reference internal" href="Internationalization.html">Internationalizing your application</a></li>
<li class="toctree-l1"><a class="reference internal" href="UnicodeTips.html">Tips for Using Non-ASCII Characters in TurboGears</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Scheduling Tasks with TurboGears</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#scheduling-jobs">Scheduling Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-task-objects-directly">Using Task Objects Directly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage-example">Usage Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ErrorReporting.html">Custom Error Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="ZeroConfSupport.html">Zeroconf support in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="StartupHook.html">Startup Hook</a></li>
<li class="toctree-l1"><a class="reference internal" href="CRUDTemplate.html">CRUD Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="RESTfulPath.html">RESTful URLs with TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="RESTfulPaginate.html">RESTful Pagination Using the Paginate Decorator</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebServices.html">WebServices with TGWebServices</a></li>
<li class="toctree-l1"><a class="reference internal" href="OAuthAuthentication.html">Validating Signed Requests from OpenSocial Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenerateFigures.html">Generating Graphs and Figures in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="FileUploadTutorial.html">File Upload Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="FileUploadProgressBar.html">File Upload Progress Bar</a></li>
<li class="toctree-l1"><a class="reference internal" href="AlternativeComponents.html">Alternative Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/UseElixir.html">Getting Started with Elixir</a></li>
<li class="toctree-l1"><a class="reference internal" href="RoutesIntegration.html">Using Routes with TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="EntryPointList.html">TurboGears Entry Point list</a></li>
<li class="toctree-l1"><a class="reference internal" href="MakingYourAppExtensible.html">Making Extensible Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="TurboGearsAndMicroApps.html">What does this have to do with TurboGears?</a></li>
<li class="toctree-l1"><a class="reference internal" href="TurboGearsAndMicroApps.html#an-example-is-worth-a-thousand-pages-worth-of-blather">An example is worth a thousand pages worth of blather</a></li>
<li class="toctree-l1"><a class="reference internal" href="TurboGearsAndMicroApps.html#now-for-the-bad-news">Now for the bad news</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingSphinx.html">Using Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="CookieDefault.html">Cookie Default</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConvertCookies.html">Converting Between Cookie Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExtraRequestParams.html">Handling Extra Request Parameters With CherryPy Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="RouteByHttpMethod.html">Routing Requests According to HTTP Request Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="VirtualHost.html">Virtual Host</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenshiRenderingWithoutExpose.html">Genshi Rendering without using &#64;expose()</a></li>
<li class="toctree-l1"><a class="reference internal" href="ServeDynamicFiles.html">Serving Dynamically Generated Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="HybridNestedSetModel.html">Hybrid Nested Set Model for Hierarchical Storage of SQLObject Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="SockFile.html">Connecting to MySQL via a socket file</a></li>
<li class="toctree-l1"><a class="reference internal" href="SelectingOption.html">Setting the selected option of a SELECT element</a></li>
<li class="toctree-l1"><a class="reference internal" href="DojoIEWorkaround.html">Dojo / IE workaround</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Philosophy.html">TurboGears Project Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plugins.html">TurboGears Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="TemplatePlugins.html">Writing a Template Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="CommandPlugins.html"><tt class="docutils literal"><span class="pre">tg-admin</span></tt> Command Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExtendingQuickstart.html">Extending Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html">TurboGears Licenses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ThirdParty.html">ThirdParty Components Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChangeLog.html">TurboGears Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TGBooks.html">TurboGears Books</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TGArticles.html">TuboGears Articles</a></li>
<li class="toctree-l1"><a class="reference internal" href="PresentationMaterial.html">TurboGears presentation material</a></li>
</ul>

        </div>
      </div>


    <div class="document">
  <div class="documentwrapper">
    <div class="body headerfix">
      
  <div class="section" id="scheduling-tasks-with-turbogears">
<span id="index-0"></span><h1><a class="toc-backref" href="#id1">Scheduling Tasks with TurboGears</a><a class="headerlink" href="#scheduling-tasks-with-turbogears" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#scheduling-tasks-with-turbogears" id="id1">Scheduling Tasks with TurboGears</a><ul>
<li><a class="reference internal" href="#scheduling-jobs" id="id2">Scheduling Jobs</a></li>
<li><a class="reference internal" href="#using-task-objects-directly" id="id3">Using Task Objects Directly</a></li>
<li><a class="reference internal" href="#usage-example" id="id4">Usage Example</a></li>
</ul>
</li>
</ul>
</div>
<p>TurboGears includes a scheduler that is based on <a class="reference external" href="http://www.razorvine.net/download/kronos.py">Kronos</a> by Irmen de Jong. This
scheduler makes it easy to have one time or recurring tasks run as needed.</p>
<p>You can schedule Python functions to be called at specific intervals or
days. It uses the standard <a class="reference external" href="http://www.python.org/doc/current/lib/module-sched.html">sched</a> module for the actual task scheduling,
but provides much more:</p>
<ul class="simple">
<li>Repeated (at intervals, or on specific days).</li>
<li>Error handling (exceptions in your tasks don&#8217;t kill the scheduler).</li>
<li>You can run the scheduler in its own thread or a separate process.</li>
<li>You can run a task in its own thread or a separate process.</li>
</ul>
<p>To use the scheduler, set the <tt class="docutils literal"><span class="pre">tg.scheduler</span></tt> config variable to <tt class="docutils literal"><span class="pre">True</span></tt> in
your <tt class="docutils literal"><span class="pre">[global]</span></tt> configuration. This tells TurboGears to start the scheduler
when the server starts.</p>
<p>Edit <tt class="docutils literal"><span class="pre">&lt;yourproject&gt;/&lt;yourpkg&gt;/config/app.cfg</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Set to True if the scheduler should be started</span>
<span class="n">tg</span><span class="o">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<div class="section" id="scheduling-jobs">
<h2><a class="toc-backref" href="#id2">Scheduling Jobs</a><a class="headerlink" href="#scheduling-jobs" title="Permalink to this headline">¶</a></h2>
<p>There are three functions in the <tt class="docutils literal"><span class="pre">turbogears.schedule</span></tt> module you can use to
schedule jobs. They are called <tt class="docutils literal"><span class="pre">add_interval_task</span></tt>, <tt class="docutils literal"><span class="pre">add_weekday_task</span></tt>, and
<tt class="docutils literal"><span class="pre">add_monthday_task</span></tt>.</p>
<p>All three functions return a <tt class="docutils literal"><span class="pre">Task</span></tt> object. If you hold on to that <tt class="docutils literal"><span class="pre">Task</span></tt>
object, you can later cancel it by calling <tt class="docutils literal"><span class="pre">turbogears.scheduler.cancel()</span></tt>
with that <tt class="docutils literal"><span class="pre">Task</span></tt>.</p>
<p>Here is an example that runs the function <tt class="docutils literal"><span class="pre">&quot;do_something&quot;</span></tt> every ten seconds:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">scheduler</span>

<span class="k">def</span> <span class="nf">do_something</span><span class="p">():</span>
    <span class="k">print</span> <span class="s">&quot;Hello world.&quot;</span>

<span class="n">scheduler</span><span class="o">.</span><span class="n">add_interval_task</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">do_something</span><span class="p">,</span> <span class="n">taskname</span><span class="o">=</span><span class="s">&#39;do_something&#39;</span><span class="p">,</span>
    <span class="n">initialdelay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>All three scheduling functions take the following arguments:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">action</span></tt></dt>
<dd>The callable that will be called at the time you request</dd>
<dt><tt class="docutils literal"><span class="pre">args</span></tt></dt>
<dd>Tuple of positional parameters to pass to the action</dd>
<dt><tt class="docutils literal"><span class="pre">kw</span></tt></dt>
<dd>Keyword arguments to pass to the action</dd>
<dt><tt class="docutils literal"><span class="pre">taskname</span></tt></dt>
<dd>Tasks can have a name (stored in <tt class="docutils literal"><span class="pre">task.name</span></tt>), which can help if you&#8217;re
trying to keep track of many tasks.</dd>
<dt><tt class="docutils literal"><span class="pre">processmethod</span></tt></dt>
<dd><p class="first">By default, each task will be run in a new thread. You can also pass in
<tt class="docutils literal"><span class="pre">turbogears.scheduler.method.sequential</span></tt> or
<tt class="docutils literal"><span class="pre">turbogears.scheduler.method.forked</span></tt>. The default is
<tt class="docutils literal"><span class="pre">turbogears.scheduler.method.threaded</span></tt>.</p>
<p><em>Sequential</em> means that the task will run in the same thread as the
scheduler, and task will be execuetd sequentially, one after another. This
should only be used for quick tasks.</p>
<p><em>Forked</em> means to fork a new process to run the job, which is sometimes more
effective for intense jobs, particularly on multiprocessor machines (due to
Python&#8217;s architecture).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">it is impossible to add new tasks to a <tt class="docutils literal"><span class="pre">ForkedScheduler</span></tt>,
after the scheduler has been started!</p>
</div>
<p>Here&#8217;s an example of how to schedule the same function as above as a task
using the sequential method:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">turbogears</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">add_interval_task</span><span class="p">(</span>
    <span class="n">processmethod</span><span class="o">=</span><span class="n">turbogears</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">sequential</span><span class="p">,</span>
    <span class="n">action</span><span class="o">=</span><span class="n">do_something</span><span class="p">,</span>
    <span class="n">taskname</span><span class="o">=</span><span class="s">&#39;do_something&#39;</span><span class="p">,</span>
    <span class="n">initialdelay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<p>In addition to these common parameters, the three scheduling functions each
offer additional options to determine when they run. Here are the four
functions and their parameters for how often to run:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">add_interval_task</span></tt></dt>
<dd><p class="first">Pass in <tt class="docutils literal"><span class="pre">initialdelay</span></tt> with a number of seconds to wait before running and
an <tt class="docutils literal"><span class="pre">interval</span></tt> with the number of seconds between runs.</p>
<p class="last">For example, an initialdelay of 600 and interval of 60 would mean &#8220;start
running after 10 minutes and run every 1 minute after that&#8221;.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">add_weekday_task</span></tt></dt>
<dd>Runs on certain days of the week. Pass in a list or tuple of <tt class="docutils literal"><span class="pre">weekdays</span></tt>
from 1-7 (where 1 is Monday). Additionally, you need to pass in
<tt class="docutils literal"><span class="pre">timeonday</span></tt> which is the time of day to run. <tt class="docutils literal"><span class="pre">timeonday</span></tt> should be a
tuple with (hour, minute).</dd>
<dt><tt class="docutils literal"><span class="pre">add_monthday_task</span></tt></dt>
<dd>Runs on certain days of the month. Pass in a list or tuple of <tt class="docutils literal"><span class="pre">monthdays</span></tt>
from 1-31, and also pass in <tt class="docutils literal"><span class="pre">timeonday</span></tt> which is an (hour, minute) tuple
of the time of day to run the task.</dd>
</dl>
</div>
<div class="section" id="using-task-objects-directly">
<h2><a class="toc-backref" href="#id3">Using Task Objects Directly</a><a class="headerlink" href="#using-task-objects-directly" title="Permalink to this headline">¶</a></h2>
<p>For more control you can create one of the following <tt class="docutils literal"><span class="pre">Task</span></tt> sub-classes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="39%" />
<col width="36%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>IntervalTask</td>
<td>ThreadedIntervalTask</td>
<td>ForkedIntervalTask</td>
</tr>
<tr class="row-even"><td>WeekdayTask</td>
<td>ThreadedWeekdayTask</td>
<td>ForkedWeekdayTask</td>
</tr>
<tr class="row-odd"><td>MonthdayTask</td>
<td>ThreadedMonthdayTask</td>
<td>ForkedMonthdayTask</td>
</tr>
</tbody>
</table>
<p>All <tt class="docutils literal"><span class="pre">Task</span></tt> sub-classes support the following methods:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">execute(self)</span></tt></dt>
<dd>Execute the actual task.</dd>
<dt><tt class="docutils literal"><span class="pre">reschedule(self,</span> <span class="pre">scheduler)</span></tt></dt>
<dd><dl class="first last docutils">
<dt><tt class="docutils literal"><span class="pre">*IntervalTask</span></tt></dt>
<dd>Reschedule this task according to its interval (in seconds).</dd>
<dt><tt class="docutils literal"><span class="pre">*WeekdayTask</span></tt></dt>
<dd>Reschedule this for tomorrow, for the given daytime.</dd>
<dt><tt class="docutils literal"><span class="pre">*MonthdayTask</span></tt></dt>
<dd>Not applicable (raises a <tt class="docutils literal"><span class="pre">NotImplementedError</span></tt> exception.).</dd>
</dl>
</dd>
</dl>
<p>You can the schedule a task using one of the following methods of a
<tt class="docutils literal"><span class="pre">Scheduler</span></tt> instance. To get and instance, you can either call
<tt class="docutils literal"><span class="pre">turbogears.schedule._get_scheduler()</span></tt> or create your own instance of one of
the following Schedule classes:</p>
<ul class="simple">
<li>Scheduler</li>
<li>ThreadedScheduler</li>
<li>ForkedScheduler</li>
</ul>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">schedule_task(self,</span> <span class="pre">task,</span> <span class="pre">delay)</span></tt></dt>
<dd>Add a new task to the scheduler with the given delay (in seconds).</dd>
<dt><tt class="docutils literal"><span class="pre">schedule_task_abs(self,</span> <span class="pre">task,</span> <span class="pre">abstime)</span></tt></dt>
<dd>Add a new task to the scheduler for the given absolute time value.</dd>
</dl>
</div>
<div class="section" id="usage-example">
<h2><a class="toc-backref" href="#id4">Usage Example</a><a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<p>You might want to use the scheduler as a kind of mini-cron to execute tasks at
regular intervals or to dynamically schedule new tasks during runtime (e.g, a
RSS reader). Where you place the code for your tasks and scheduling them will
depend on your application. In any case you will need to run a function to (re)
schedule your tasks after application startup.</p>
<p>For example, you could use the scheduler to regularly run jobs ranging from
reporting to updating the database using external data. For this purpose, you
might create a <tt class="docutils literal"><span class="pre">jobs.py</span></tt> file in your applications package, containing a
function per &#8216;job&#8217; and <tt class="docutils literal"><span class="pre">schedule()</span></tt> function to schedule the tasks during
startup. <tt class="docutils literal"><span class="pre">jobs.py</span></tt> basically reads as follows:</p>
<div class="highlight-python"><pre># jobs.py

import datetime
from turbogears.scheduler import add_weekday_task, add_interval_task

def generate_product_ranking():
    # do something useful here...
    pass

def synchronize_stock(from=None):
    # do something useful here...
    pass

def schedule():
    add_weekday_task(action=generate_product_ranking,
        weekdays=range(1,8), timeonday=(0))

    add_interval_task(action=synchronize_stock,
        args=[lambda:datetime.datetime.now() -
            datetime.timedelta(minutes=2)],
        interval=120)</pre>
</div>
<p>Then add two lines to the <tt class="docutils literal"><span class="pre">start()</span></tt> function in <tt class="docutils literal"><span class="pre">commands.py</span></tt>, just before
the TurboGears server is started, to run the schedule function at each startup
(assuming your applications package is called <tt class="docutils literal"><span class="pre">yourpkg</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># commands.py</span>

<span class="o">...</span>

<span class="k">def</span> <span class="nf">start</span><span class="p">():</span>

    <span class="o">...</span>

    <span class="c"># following two lines added</span>
    <span class="kn">from</span> <span class="nn">yourpkg</span> <span class="kn">import</span> <span class="n">jobs</span>
    <span class="n">turbogears</span><span class="o">.</span><span class="n">startup</span><span class="o">.</span><span class="n">call_on_startup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jobs</span><span class="o">.</span><span class="n">schedule</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">yourpkg.controllers</span> <span class="kn">import</span> <span class="n">Root</span>
    <span class="n">turbogears</span><span class="o">.</span><span class="n">start_server</span><span class="p">(</span><span class="n">Root</span><span class="p">())</span>
</pre></div>
</div>
<p>As another example, you can use the scheduler to delete expired entries in the identity tables. The following assumes you&#8217;re using SQLAlchemy and a PostgreSQL database, but you can easily adapt this to your database configuration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># jobs.py</span>

<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">sql</span>

<span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">turbogears.scheduler</span> <span class="kn">import</span> <span class="n">add_interval_task</span>

<span class="kn">from</span> <span class="nn">yourpkg.model</span> <span class="kn">import</span> <span class="n">visits_table</span><span class="p">,</span> <span class="n">visit_identity_table</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;yourpkg.jobs&quot;</span><span class="p">)</span>

<span class="n">_expired_visits</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">&quot;expiry&lt;current_timestamp-&#39;15min&#39;::interval&quot;</span><span class="p">)</span>
<span class="n">_orphaned_identities</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s">&quot;not exists(select * from visit&quot;</span>
    <span class="s">&quot; where visit_key=visit_identity.visit_key)&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">delete_expired_visits</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Delete expired visits from database.&quot;&quot;&quot;</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Deleting expired visits from database...&quot;</span><span class="p">)</span>
    <span class="n">visits_table</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">_expired_visits</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
    <span class="n">visit_identity_table</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">_orphaned_identities</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">schedule</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;tg.scheduler&#39;</span><span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Scheduling background jobs...&quot;</span><span class="p">)</span>
        <span class="n">add_interval_task</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="n">delete_expired_visits</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">30</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s">&quot;Scheduler not activated!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


    </div>
  </div>
      <div class="clearer"></div>
    </div>
  <div class="footer"><span>
      &copy; Copyright 
      by the <a href="">TurboGears</a> Doc Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
  </span></div>
  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-7088080-2");
  pageTracker._trackPageview();
  } catch(err) {}</script>
  </body>
</html>