
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Testing Your Application &mdash; TurboGears 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/tg.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <script type="text/javascript" src="_static/header.js"></script>
    <link rel="top" title="TurboGears 1.0 documentation" href="index.html" />
    <link rel="next" title="Understanding the Logging System" href="LoggingSystem.html" />
    <link rel="prev" title="OpenID Authentication with TurboGears Identity" href="Identity/OpenID.html" />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="LoggingSystem.html" title="Understanding the Logging System"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Identity/OpenID.html" title="OpenID Authentication with TurboGears Identity"
             accesskey="P">previous</a> |</li>
<li><a href="index.html">TurboGears 1.0 documentation</a> &raquo;</li>
<li id="searchbox" style="display: none; margin: 0 20px;" class="right">
  <form class="search" action="search.html" method="get">
    <span>Search:</span>
    <input type="text" name="q" size="18" />
    <input type="submit" value="Go" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</li>
<script type="text/javascript">$('#searchbox').show(0);</script>
 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">TurboGears 1.0 FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Install/index.html">Downloading and Installing TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install/Deployment.html">Deploying TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Database/index.html">Database Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/BigPicture.html">The Big Picture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TGScreencasts.html">TurboGears Screencasts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Wiki20/Page1.html">The 20 Minutes Wiki</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Controller.html">Controller Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Arguments.html">I Wanted An Argument!</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/UseDatabase.html">Data Model Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Kid.html">A Brief Introduction to Kid Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/MochiKit.html">A Brief Introduction to MochiKit</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Identity/GettingStarted.html">Getting Started With Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Introduction.html">Introduction To Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/SimpleForm.html">Simple Widget Form Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="FileUploadTutorial.html">File Upload Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ToDoListTutorial.html">Brian&#8217;s TurboGears Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TgAdmin.html">tg-admin command line tool reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="QuickStart.html">Are you ready to gear up?</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Server.html">Starting Up The Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">TurboGears Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingBigApplications.html">Creating Big Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="SpecificProblems.html">Solving specific problems</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/Arguments.html">I Wanted An Argument!</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/URLs.html">Using URLs</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingBigApplications.html">Creating Big Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="RequestResponse.html">Access Request/Response Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="StaticFiles.html">Serving Static Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cookies.html">Using Cookies in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sessions.html">Using Sessions in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="FeedController.html">Serving RSS and Atom feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="UnifiedControllers.html">Unified Form Data Validation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ExposeDecorator.html">&#64;expose()</a></li>
<li class="toctree-l1"><a class="reference internal" href="ValidateDecorator.html">&#64;validate()</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorHandling.html">Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/Usage.html">Using Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="PaginateDecorator.html">&#64;paginate()</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="StdVars.html"><tt class="docutils literal"><span class="pre">stdvars</span></tt>: Global Template Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="HeadersFooters.html">Application-wide Headers and Footers</a></li>
<li class="toctree-l1"><a class="reference internal" href="JSON.html">JSON Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="Designer.html">Designer-Friendly Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="DummyTemplate.html">Dummy Kid Template for Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="KidHTMLEntities.html">HTML Entities in Kid templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="CheckedCheckBox.html">Automatically Checking a Checkbox or Radio Button</a></li>
<li class="toctree-l1"><a class="reference internal" href="BreadCrumb.html">Breadcrumb Style Navigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="CreatingBigApplications.html">Creating Big Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="NonPackagedKidTemplates.html">Loading Kid templates from outside your application package</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenshiInternationalizationWithBabel.html">Genshi Templates Internationalization with Babel</a></li>
<li class="toctree-l1"><a class="reference internal" href="AdvancedCheetahTemplates.html">Templates for using TurboCheetah with TurboGears</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/DefineDatabase.html">Data Model Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="BackEndOverview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="BackEndOverview.html#supported-backends">Supported backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="DbUri.html">The DB-URI</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/index.html">SQLObject Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="TgAdminSqlUpgrade.html">How to Use <tt class="docutils literal"><span class="pre">tgadmin</span> <span class="pre">sql</span> <span class="pre">upgrade</span></tt> with SQLObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelOutsideTG.html">Using Your Model Outside of TurboGears Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultipleDatabases.html">Using Multiple Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/AutoUpdateField.html">Auto-updating an attribute with SQLObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Debug.html">SQLObject Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/DirectSQL.html">SQLObject direct SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/ForeignKeys.html">SQLObject Foreign Keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/QuickGuide.html">SQLObject Quick Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/ReservedWords.html">Avoiding SQL reserved words in the model definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Caching.html">SQLObject Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Gotchas.html">SQLObject &#8220;gotcha&#8217;s&#8221;</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/StoringAndRetrievingFiles.html">Storing and Retrieving Files from a Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Views.html">Views in SQLObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/VsHibernate.html">Hibernate vs SqlObject</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLAlchemy/Configuration.html">SQLAlchemy Configuration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Overview.html">Widgets Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/index.html">Guide to the TurboGears Widgets Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Browser.html">WidgetBrowser</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Explore.html">Dive Into Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/SimpleForm.html">Simple Widget Form Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/FormValidationWithSchemas.html">Widget Form Validation with Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/ModifyDefaults.html">Changing Widget Defaults at Run Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/DynamicForm.html">Dynamically Modifying a Form&#8217;s Widgets With Ajax</a></li>
<li class="toctree-l1"><a class="reference internal" href="DynamicValidation.html">Dynamic Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Packages.html">Widget Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/StatelessWidgets.html">StatelessWidgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/DataGrid.html">DataGrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/AjaxGrid.html">Ajax Grid Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/AutoCompleteField.html">The AutoCompleteField Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/RemoteForm.html">RemoteForm Widget Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/RemoteLink.html">Wrap Ajax Operations in Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/CompoundWidgets.html">Implementing and using CompoundWidgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/RepeatingFieldSet.html">RepeatingFieldSet Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/CalendarDatePicker.html">CalendarDatePicker Widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/NicerForms.html">Nicer Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="FastData/index.html">FastData</a></li>
<li class="toctree-l1"><a class="reference internal" href="FastData/DataController.html">DataController</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Recipes.html">Widget Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Tips.html">Widget Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="ToscaWidgets.html">Using ToscaWidgets in TurboGears 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Visit/index.html">Using the Visit Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visit/Extending.html">Extending the Visit Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visit/UserTrackedLogging.html">User Tracked Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visit/PermanentLogin.html">Permanent Login</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/index.html">Identity Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/GettingStarted.html">Getting Started With Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/Usage.html">Using Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/EncryptedPassword.html">Using Identity with Encrypted Passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/Recipes.html">Identity Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Identity/OpenID.html">OpenID Authentication with TurboGears Identity</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Testing Your Application</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#executing-the-test-suite">Executing the test suite</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing-basics">Testing Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#turbogears-specific-testing-the-testutil-module">TurboGears-specific Testing: the <tt class="docutils literal"><span class="pre">testutil</span></tt> Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#testing-your-view">Testing Your View</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-your-controller">Testing Your Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-your-model">Testing Your Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#browsingsession">BrowsingSession</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-functionality">Other Functionality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#issues-with-cherrypy-filters">Issues With CherryPy Filters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LoggingSystem.html">Understanding the Logging System</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorReporting.html">Custom Error Reporting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Debugging.html">Debugging a TurboGears Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="DummyTemplate.html">Dummy Kid Template for Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="SQLObject/Debug.html">SQLObject Debugging</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="CachingTechniques.html">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="GzipCompressing.html">Gzip Compressing Content</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingPylint.html">Using Pylint to Improve the Quality of Your Code</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Toolbox.html">TurboGears Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="Admi18n.html">The Admi18n Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="Catwalk.html">CatWalk</a></li>
<li class="toctree-l1"><a class="reference internal" href="FastData/DataController.html">DataController</a></li>
<li class="toctree-l1"><a class="reference internal" href="VersionInfo.html">Toolbox Info</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelDesigner.html">ModelDesigner</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebConsole.html">Web Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="Widgets/Browser.html">WidgetBrowser</a></li>
<li class="toctree-l1"><a class="reference internal" href="DreamWeaverIntegration.html">DreamWeaver Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="VimIntegration.html">Vim Editor Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="FlashNotes.html">Using Flash Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="JsonifyDecorator.html">The <tt class="docutils literal"><span class="pre">jsonify</span></tt> Decorator</a></li>
<li class="toctree-l1"><a class="reference internal" href="Internationalization.html">Internationalizing your application</a></li>
<li class="toctree-l1"><a class="reference internal" href="UnicodeTips.html">Tips for Using Non-ASCII Characters in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="Scheduler.html">Scheduling Tasks with TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="ErrorReporting.html">Custom Error Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="ZeroConfSupport.html">Zeroconf support in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="StartupHook.html">Startup Hook</a></li>
<li class="toctree-l1"><a class="reference internal" href="CRUDTemplate.html">CRUD Template</a></li>
<li class="toctree-l1"><a class="reference internal" href="RESTfulPath.html">RESTful URLs with TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="RESTfulPaginate.html">RESTful Pagination Using the Paginate Decorator</a></li>
<li class="toctree-l1"><a class="reference internal" href="WebServices.html">WebServices with TGWebServices</a></li>
<li class="toctree-l1"><a class="reference internal" href="OAuthAuthentication.html">Validating Signed Requests from OpenSocial Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenerateFigures.html">Generating Graphs and Figures in TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="FileUploadTutorial.html">File Upload Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="FileUploadProgressBar.html">File Upload Progress Bar</a></li>
<li class="toctree-l1"><a class="reference internal" href="AlternativeComponents.html">Alternative Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted/UseElixir.html">Getting Started with Elixir</a></li>
<li class="toctree-l1"><a class="reference internal" href="RoutesIntegration.html">Using Routes with TurboGears</a></li>
<li class="toctree-l1"><a class="reference internal" href="EntryPointList.html">TurboGears Entry Point list</a></li>
<li class="toctree-l1"><a class="reference internal" href="MakingYourAppExtensible.html">Making Extensible Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="TurboGearsAndMicroApps.html">What does this have to do with TurboGears?</a></li>
<li class="toctree-l1"><a class="reference internal" href="TurboGearsAndMicroApps.html#an-example-is-worth-a-thousand-pages-worth-of-blather">An example is worth a thousand pages worth of blather</a></li>
<li class="toctree-l1"><a class="reference internal" href="TurboGearsAndMicroApps.html#now-for-the-bad-news">Now for the bad news</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingSphinx.html">Using Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="CookieDefault.html">Cookie Default</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConvertCookies.html">Converting Between Cookie Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExtraRequestParams.html">Handling Extra Request Parameters With CherryPy Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="RouteByHttpMethod.html">Routing Requests According to HTTP Request Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="VirtualHost.html">Virtual Host</a></li>
<li class="toctree-l1"><a class="reference internal" href="GenshiRenderingWithoutExpose.html">Genshi Rendering without using &#64;expose()</a></li>
<li class="toctree-l1"><a class="reference internal" href="ServeDynamicFiles.html">Serving Dynamically Generated Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="HybridNestedSetModel.html">Hybrid Nested Set Model for Hierarchical Storage of SQLObject Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="SockFile.html">Connecting to MySQL via a socket file</a></li>
<li class="toctree-l1"><a class="reference internal" href="SelectingOption.html">Setting the selected option of a SELECT element</a></li>
<li class="toctree-l1"><a class="reference internal" href="DojoIEWorkaround.html">Dojo / IE workaround</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Philosophy.html">TurboGears Project Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Plugins.html">TurboGears Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="TemplatePlugins.html">Writing a Template Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="CommandPlugins.html"><tt class="docutils literal"><span class="pre">tg-admin</span></tt> Command Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExtendingQuickstart.html">Extending Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="License.html">TurboGears Licenses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ThirdParty.html">ThirdParty Components Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChangeLog.html">TurboGears Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TGBooks.html">TurboGears Books</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TGArticles.html">TuboGears Articles</a></li>
<li class="toctree-l1"><a class="reference internal" href="PresentationMaterial.html">TurboGears presentation material</a></li>
</ul>

        </div>
      </div>


    <div class="document">
  <div class="documentwrapper">
    <div class="body headerfix">
      
  <div class="section" id="testing-your-application">
<span id="index-0"></span><h1><a class="toc-backref" href="#id3">Testing Your Application</a><a class="headerlink" href="#testing-your-application" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#testing-your-application" id="id3">Testing Your Application</a><ul>
<li><a class="reference internal" href="#executing-the-test-suite" id="id4">Executing the test suite</a></li>
<li><a class="reference internal" href="#testing-basics" id="id5">Testing Basics</a></li>
<li><a class="reference internal" href="#turbogears-specific-testing-the-testutil-module" id="id6">TurboGears-specific Testing: the <tt class="docutils literal"><span class="pre">testutil</span></tt> Module</a></li>
<li><a class="reference internal" href="#issues-with-cherrypy-filters" id="id7">Issues With CherryPy Filters</a></li>
</ul>
</li>
</ul>
</div>
<p>Test-driven development (TDD) is a powerful (and increasingly popular)
development strategy. In TDD, you write tests before you write your code. This
helps you to solidify in your mind what the code should be doing and ensures it
will be structured as you want. Test driven development also encourages good
architecture decisions such as modularization because you can&#8217;t test what you
can&#8217;t access!</p>
<p>Even if you don&#8217;t write tests first, having automated tests can be a lifesaver
when the inevitable change request comes and you have to refactor your program
to fit the new requirements.</p>
<p id="index-1">When you install TurboGears, you also get <a class="reference external" href="http://somethingaboutorange.com/mrl/projects/nose/">Nose</a> for free <a class="footnote-reference" href="#testtools" id="id1">[1]</a>. Nose
(written by Jason Pellerin) is a powerful and convenient extension to the
standard library  module <a class="reference external" href="http://docs.python.org/lib/module-unittest.html">unittest</a> and comes with its own discovery-based test
runner.</p>
<table class="docutils footnote" frame="void" id="testtools" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><p class="first">You need to request the &#8220;testtools&#8221; option when installing
TurboGears to get Nose:</p>
<div class="last highlight-python"><pre>tgsetup.py TurboGears[testtools]</pre>
</div>
</td></tr>
</tbody>
</table>
<div class="section" id="executing-the-test-suite">
<h2><a class="toc-backref" href="#id4">Executing the test suite</a><a class="headerlink" href="#executing-the-test-suite" title="Permalink to this headline">¶</a></h2>
<p>When using Nose, all you have to do to run your test suite is open your console
and execute following command in your project directory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nosetests</span>
</pre></div>
</div>
<p>The <a class="reference external" href="http://somethingaboutorange.com/mrl/projects/nose/#usage">nosetests</a> command will search you project for test cases (any class or
method that has a <tt class="docutils literal"><span class="pre">test</span></tt>/<tt class="docutils literal"><span class="pre">Test</span></tt>/<tt class="docutils literal"><span class="pre">TEST</span></tt> prefix) in your project directory,
execute all those test cases and give you a report on the outcome.</p>
<p>By running your tests before you commit to source control repository (you are
using source control, right?), you can catch unintended consequences of your
edit before they become an issue in production. Early detection also makes
tracking down the bug considerably simpler.</p>
<p>When a tests produces an error, nose will try to reload you test module, thereby
causing errors because the model will get loaded twice. If you have trouble
finding out whcih test case is the culprit, run nose with</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nosetests</span> <span class="o">-</span><span class="n">x</span>
</pre></div>
</div>
<p>and it will stop after the first test which fails or produces an error.
<tt class="docutils literal"><span class="pre">nosetests</span></tt> has many other useful command line options. Run</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nosetests</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>to view the help message and find out more about them.</p>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>You can put test-specific configuration into the <tt class="docutils literal"><span class="pre">test.cfg</span></tt> file in your
project directory. This allows you, for example, to have a special logging
configuration when running tests or, the most common case, to define a
different <cite>dburi</cite> for test, so your test will work with a database
specially set up for tests or an in-memory database that will get
wiped before/after each test.</p>
<p>For more information see the <a class="reference internal" href="Configuration.html"><em>Configuration</em></a> page and the section on testing
your model below.</p>
</div>
</div>
<div class="section" id="testing-basics">
<h2><a class="toc-backref" href="#id5">Testing Basics</a><a class="headerlink" href="#testing-basics" title="Permalink to this headline">¶</a></h2>
<p>A simple test demonstration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This method is a demo to be tested</span>
<span class="k">def</span> <span class="nf">getsum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="c"># Test case are start with :doc:`/test`</span>
<span class="k">def</span> <span class="nf">test_getsum</span><span class="p">():</span>
    <span class="k">assert</span> <span class="mi">3</span> <span class="o">==</span> <span class="n">getsum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="mi">4</span> <span class="o">!=</span> <span class="n">getsum</span><span class="p">(</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>As mentioned, Nose looks for modules that start with <tt class="docutils literal"><span class="pre">test</span></tt>. In the above
example, it will find the <tt class="docutils literal"><span class="pre">test_getsum()</span></tt> function and the report from
<tt class="docutils literal"><span class="pre">nosetests</span></tt> will show that one (1) test passed. By convention, test modules
go into separate packages called &#8220;tests&#8221; located beneath the package they are
testing, though Nose does not require this (as the above example demonstrates).</p>
<p>Nose tries to be as unobtrusive as possible. For example you can write your
tests using the standard Python <tt class="docutils literal"><span class="pre">assert</span></tt> statement, which raises an error
if an expression returns <tt class="docutils literal"><span class="pre">False</span></tt>, or equivalent.  The <tt class="docutils literal"><span class="pre">assert</span></tt> statement
also takes an optional second argument, which is a human-readable
description of the test case, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">assert</span> <span class="mi">4</span> <span class="ow">is</span> <span class="n">getsum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s">&quot;assert that 1 + 2 == 4&quot;</span>
</pre></div>
</div>
<p>This is a failing test which, when run with <tt class="docutils literal"><span class="pre">nosetests</span> <span class="pre">-d</span></tt>, will output:</p>
<div class="highlight-python"><pre>File "/path/to/file.py", line XX, in test_getsum:
  assert 4 is getsum(1, 2), "assert that 1 + 2 == 4"
  AssertionError: assert 4 is getsum(1, 2)
        &gt;&gt;  assert 4 is getsum(1, 2), "assert that 1 + 2 == 4"</pre>
</div>
<p>The last line is the nosetests assert introspection, which will replace the
variables on the line (there aren&#8217;t any here) with the values.</p>
<p>The only portion of assertion testing that gets a bit ugly occurs when testing
for exceptions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">try</span><span class="p">:</span>
    <span class="n">test_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s">&#39;five&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&quot;Should have raised ValueError&quot;</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">assert</span> <span class="s">&quot;invalid literal&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="turbogears-specific-testing-the-testutil-module">
<h2><a class="toc-backref" href="#id6">TurboGears-specific Testing: the <tt class="docutils literal"><span class="pre">testutil</span></tt> Module</a><a class="headerlink" href="#turbogears-specific-testing-the-testutil-module" title="Permalink to this headline">¶</a></h2>
<p>Testing web applications isn&#8217;t as easy as testing other environments. There&#8217;s
the request dispatching and handling as well as the database setup and teardown.
The <tt class="docutils literal"><span class="pre">turbogears.testutil</span></tt> module was written to facilitate testing for the
TurboGears framework itself, but it&#8217;s in the framework because it&#8217;s useful for
testing your applications as well.</p>
<div class="section" id="testing-your-view">
<h3>Testing Your View<a class="headerlink" href="#testing-your-view" title="Permalink to this headline">¶</a></h3>
<p>Here&#8217;s the sample <tt class="docutils literal"><span class="pre">controllers.py</span></tt> file that will be used for our examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">expose</span>

<span class="k">class</span> <span class="nc">Root</span><span class="p">:</span>
    <span class="nd">@expose</span><span class="p">(</span><span class="n">html</span><span class="o">=</span><span class="s">&quot;projectname.templates.welcome&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s">&quot;0&quot;</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">newvalue</span><span class="o">=</span><span class="n">value</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is the test module for the above controller:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">testutil</span>
<span class="kn">from</span> <span class="nn">projectname.controllers</span> <span class="kn">import</span> <span class="n">Root</span>
<span class="kn">import</span> <span class="nn">cherrypy</span>

<span class="c">##The template contains</span>
<span class="c">#</span>
<span class="c"># The new value is ${newvalue}.</span>

<span class="c"># to test template</span>
<span class="k">def</span> <span class="nf">test_withtemplate</span><span class="p">():</span>
    <span class="s">&quot;Tests the output passed through a template&quot;</span>
    <span class="n">cherrypy</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">Root</span><span class="p">()</span>
    <span class="n">testutil</span><span class="o">.</span><span class="n">create_request</span><span class="p">(</span><span class="s">&quot;/?value=27&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="s">&quot;The new value is 54.&quot;</span> <span class="ow">in</span> <span class="n">cherrypy</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Here we&#8217;re not using any of the Nose-provided setup and teardown functionality,
we&#8217;re doing everything in our test function. The docstring provides nicer output
for failing tests in the testrunner.</p>
<p>In order to test out CherryPy, we need an active root object, this is created
by setting <tt class="docutils literal"><span class="pre">cherrypy.root</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cherrypy</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">Root</span><span class="p">()</span>
</pre></div>
</div>
<p>With the root created, the <tt class="docutils literal"><span class="pre">testutil.create_request</span></tt> creates a fake request
that passes through all the CherryPy url traversal, the decorators for our
function, template processing, etc. The request is processed and results put in
<tt class="docutils literal"><span class="pre">cherrypy.response</span></tt>, but the response isn&#8217;t sent anywhere.</p>
<p>With the request processed, we test for correctness by using the <tt class="docutils literal"><span class="pre">in</span></tt> operator
to find our modified substring in the body (<tt class="docutils literal"><span class="pre">cherrypy.response.body[0]</span></tt>).</p>
</div>
<div class="section" id="testing-your-controller">
<h3>Testing Your Controller<a class="headerlink" href="#testing-your-controller" title="Permalink to this headline">¶</a></h3>
<p>Continuing with our previous example, we&#8217;ll write a test that calls the
<tt class="docutils literal"><span class="pre">index()</span></tt> method directly, bypassing CherryPy and our templates:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">testutil</span>
<span class="kn">from</span> <span class="nn">projectname.controllers</span> <span class="kn">import</span> <span class="n">Root</span>
<span class="kn">import</span> <span class="nn">cherrypy</span>

<span class="c"># to test controller</span>
<span class="k">def</span> <span class="nf">test_directcall</span><span class="p">():</span>
    <span class="s">&quot;Tests the output of the method without the template&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">Root</span><span class="p">()</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">testutil</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s">&quot;5&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">d</span><span class="p">[</span><span class="s">&quot;newvalue&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
<p>Despite not going through CherryPy, we do still need an instance of our project
<tt class="docutils literal"><span class="pre">Root</span></tt>. The <tt class="docutils literal"><span class="pre">testutil.call()</span></tt> method is then used to call our function,
which returns an object. The first argument to <tt class="docutils literal"><span class="pre">testutil.call()</span></tt> is a
reference to the method, the remainder are <tt class="docutils literal"><span class="pre">*args</span></tt> or <tt class="docutils literal"><span class="pre">**kwargs</span></tt>. The return
value for the controller is returned by <tt class="docutils literal"><span class="pre">call</span></tt> and can be tested as shown.</p>
<p>If your model makes use of the values in <tt class="docutils literal"><span class="pre">cherrypy.request</span></tt> or you&#8217;d like to
check <tt class="docutils literal"><span class="pre">cherrypy.response</span></tt> in addition to the dictionary output, you can use
the <tt class="docutils literal"><span class="pre">testutil.call_with_request()</span></tt>. <tt class="docutils literal"><span class="pre">call_with_request()</span></tt> takes both a
method reference and a <tt class="docutils literal"><span class="pre">request</span></tt> as parameters and returns a tuple of the
method output and the response object. If you don&#8217;t have a request object handy,
use <tt class="docutils literal"><span class="pre">testutil.DummyRequest</span></tt> to create a fake one.</p>
</div>
<div class="section" id="testing-your-model">
<h3>Testing Your Model<a class="headerlink" href="#testing-your-model" title="Permalink to this headline">¶</a></h3>
<p>Testing your model is a thorny problem for unit testing, since the output is
usually very dependent on the state of your database. This means that you&#8217;ll
probably need a separate database for testing. To make this simpler, TurboGears
provides the <tt class="docutils literal"><span class="pre">testutil.DBTest</span></tt> class.</p>
<p>If you inherit from this class, and you are using <a class="reference internal" href="SQLObject/index.html"><em>SQLObject</em></a>,
TG will provide <tt class="docutils literal"><span class="pre">setUp()</span></tt> and <tt class="docutils literal"><span class="pre">tearDown()</span></tt> methods that create and drop all
the tables in your model for each method. In the example below,
<tt class="docutils literal"><span class="pre">test_model_reset()</span></tt> is working on a completely empty
database despite coming after <tt class="docutils literal"><span class="pre">test_name()</span></tt>, thanks to the <tt class="docutils literal"><span class="pre">setUp()</span></tt> and
<tt class="docutils literal"><span class="pre">tearDown()</span></tt> methods inherited from <tt class="docutils literal"><span class="pre">testutil.DBTest</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">testutil</span>
<span class="c">## from turbogears import database</span>
<span class="c">## database.set_db_uri(&quot;sqlite:///:memory:&quot;) #this is the default</span>

<span class="kn">from</span> <span class="nn">projectname</span> <span class="kn">import</span> <span class="n">model</span>


<span class="k">class</span> <span class="nc">TestMyURL</span><span class="p">(</span><span class="n">testutil</span><span class="o">.</span><span class="n">DBTest</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="k">def</span> <span class="nf">test_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">MyUrl</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;TurboGears&quot;</span><span class="p">,</span>
              <span class="n">link</span><span class="o">=</span><span class="s">&quot;http://www.turbogears.com&quot;</span><span class="p">,</span>
              <span class="n">description</span><span class="o">=</span><span class="s">&quot;cool python web framework&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="s">&#39;TurboGears&#39;</span>

    <span class="k">def</span> <span class="nf">test_model_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">MyUrl</span><span class="o">.</span><span class="n">select</span><span class="p">())</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="ow">is</span> <span class="mi">0</span>
</pre></div>
</div>
<p>If you want to define your own <tt class="docutils literal"><span class="pre">setUp()</span></tt> and/or <tt class="docutils literal"><span class="pre">tearDown()</span></tt> make
sure that you call those methods from the parent class or you&#8217;ll get
<tt class="docutils literal"><span class="pre">OperationalError:</span> <span class="pre">no</span> <span class="pre">such</span> <span class="pre">table:</span> <span class="pre">...</span></tt> exceptions.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">turbogears</span> <span class="kn">import</span> <span class="n">testutil</span>
<span class="kn">from</span> <span class="nn">projectname</span> <span class="kn">import</span> <span class="n">model</span>

<span class="k">class</span> <span class="nc">TestMyURL</span><span class="p">(</span><span class="n">testutil</span><span class="o">.</span><span class="n">DBTest</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Pre-test setup.</span>

<span class="sd">        Use the parent class setUp() method to create database tables,</span>
<span class="sd">        then ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TestMyURL</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">setUp</span><span class="p">()</span>
        <span class="c"># Additional set-up code</span>


    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Post-test tear-down.</span>

<span class="sd">        Use parent class tearDown() method to reset database</span>
<span class="sd">        before next test.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TestMyURL</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">tearDown</span><span class="p">()</span>
        <span class="c"># Additional tear-down code</span>
</pre></div>
</div>
</div>
<div class="section" id="browsingsession">
<h3>BrowsingSession<a class="headerlink" href="#browsingsession" title="Permalink to this headline">¶</a></h3>
<p>For another alternative, you can use testutil&#8217;s BrowsingSession class to test
your application using a browser metaphor.  Simply create an instance and use
the <cite>goto</cite> method to navigate your site.  The <cite>response</cite> attribute will contain
the body of your page.   If the page sets a cookie, it will be available under
the <cite>cookie</cite> attribute:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">bs1</span> <span class="o">=</span> <span class="n">testutil</span><span class="o">.</span><span class="n">BrowsingSession</span><span class="p">()</span>
<span class="n">bs2</span> <span class="o">=</span> <span class="n">testutil</span><span class="o">.</span><span class="n">BrowsingSession</span><span class="p">()</span>
<span class="n">bs1</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s">&#39;/login?user_name=emma&amp;password=secret&amp;login=Login&#39;</span><span class="p">)</span>
<span class="n">bs2</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s">&#39;/login?user_name=paul&amp;password=passwd&amp;login=Login&#39;</span><span class="p">)</span>
<span class="n">bs1</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="n">bs2</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">&#39;emma&#39;</span> <span class="ow">in</span> <span class="n">bs1</span><span class="o">.</span><span class="n">response</span>
<span class="k">assert</span> <span class="s">&#39;paul&#39;</span> <span class="ow">in</span> <span class="n">bs2</span><span class="o">.</span><span class="n">response</span>
</pre></div>
</div>
<p>If your application sets an encoding in the &#8216;Content-Type&#8217; header, the
BrowsingSession instance will have a unicode_response attribute assigned
as well.</p>
</div>
<div class="section" id="other-functionality">
<h3>Other Functionality<a class="headerlink" href="#other-functionality" title="Permalink to this headline">¶</a></h3>
<p>Since <tt class="docutils literal"><span class="pre">testutil</span></tt> was developed to test the TurboGears framework, there are
a number of other methods that are generally less useful outside the framework
but are listed here for completeness:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">capture_log(category)</span></tt></dt>
<dd>Category is the name passed to <tt class="docutils literal"><span class="pre">logging.getLogger()</span></tt> (e.g
<tt class="docutils literal"><span class="pre">'projectname.controllers'</span></tt> is the default controller logger). You
<strong>must</strong> call <tt class="docutils literal"><span class="pre">print_log()</span></tt> or <tt class="docutils literal"><span class="pre">get_log()</span></tt> to reset the logger when
you&#8217;re done.</dd>
<dt><tt class="docutils literal"><span class="pre">print_log()</span></tt></dt>
<dd>Prints the captured log to stdout and resets the log.</dd>
<dt><tt class="docutils literal"><span class="pre">get_log()</span></tt></dt>
<dd>Returns the captured list of log messages and resets the log.</dd>
<dt><tt class="docutils literal"><span class="pre">catch_validation_errors(widget,</span> <span class="pre">value)</span></tt></dt>
<dd>Tries to create <tt class="docutils literal"><span class="pre">widget</span></tt> using <tt class="docutils literal"><span class="pre">value</span></tt>, returns a tuple of the widget
and the dict of Invalid instances.</dd>
<dt><tt class="docutils literal"><span class="pre">sqlalchemy_cleanup()</span></tt></dt>
<dd>Completely resets all sqlalchemy functionality in TG.</dd>
<dt><tt class="docutils literal"><span class="pre">reset_cp()</span></tt></dt>
<dd>Sets <tt class="docutils literal"><span class="pre">cherrypy.root</span></tt> to <tt class="docutils literal"><span class="pre">None</span></tt></dd>
</dl>
</div>
</div>
<div class="section" id="issues-with-cherrypy-filters">
<h2><a class="toc-backref" href="#id7">Issues With CherryPy Filters</a><a class="headerlink" href="#issues-with-cherrypy-filters" title="Permalink to this headline">¶</a></h2>
<p>When testing your TurboGears application you should be aware of some issues
which can bite you. The main problem is that <tt class="docutils literal"><span class="pre">testutil.call(...,</span> <span class="pre">...)</span></tt> won&#8217;t
trigger any CherryPy filters. These filters modify the originally requested
object or the request parameters. The main difference between filters and
function decorators is that filters will be executed on all exposed methods
while decorators are specific for the decorated functionality.</p>
<p>Some important functionality in TurboGears is implemented as a CherryPy filter,
especially visit tracking and identity authentication. Therefore you can not
test your login page easily. In order to test other methods which rely on
identity for user authorization, there is a special method <tt class="docutils literal"><span class="pre">set_identity_user</span></tt>
in <tt class="docutils literal"><span class="pre">turbogears.testutil</span></tt> which can be used to set a user before using
<tt class="docutils literal"><span class="pre">testutil.call(...)</span></tt>.</p>
<p>Another catch may be the <a class="reference external" href="http://www.formencode.org/Validator.html#http-html-form-input">NestedVariablesFilter</a>, which is implemented as a
filter too. You can either pass the nested dictionary to you method under test
or use <tt class="docutils literal"><span class="pre">NestedVariables.to_python(...)</span></tt> manually before actually calling the
real method.</p>
<div class="highlight-python"><pre>from formencode.variabledecode import NestedVariables
from turbogears import testutil

# first method
args = {'phone': [{'nr': '12345', 'area_code': '042'},
                  {'nr': '6789', 'area_code': '021'}]
        'name': 'Foo'}
result = testutil.call(self.root.save, **args)

# second method
args = {'phone-1.nr': '12345', 'phone-1.area_code': '042',
        'phone-2.nr': '6789', 'phone-2.area_code': '021',
        'name': 'Foo'}
args = NestedVariables.to_python(args)
result =  testutil.call(self.root.save, **args)</pre>
</div>
<p>Note you can avoid these problems by using <tt class="docutils literal"><span class="pre">testutil.create_request(...)</span></tt>
because this will create a faked request which goes through all stages
of CherryPy&#8217;s request processing as mentioned above. The disadvantage is that
you will get only the generated output from your template engine so you can&#8217;t
easily extract all variables passed to the template.</p>
</div>
</div>


    </div>
  </div>
      <div class="clearer"></div>
    </div>
  <div class="footer"><span>
      &copy; Copyright 
      by the <a href="">TurboGears</a> Doc Team.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
  </span></div>
  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-7088080-2");
  pageTracker._trackPageview();
  } catch(err) {}</script>
  </body>
</html>